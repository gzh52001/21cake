{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _toConsumableArray from 'babel-runtime/helpers/toConsumableArray';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n/* tslint:disable:jsx-no-multiline-js */\n\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport Button from '../button';\nimport Flex from '../flex';\nimport List from '../list';\nimport { getComponentLocale } from '../_util/getLocale';\nimport SubMenu from './SubMenu';\n\nvar Menu = function (_React$Component) {\n  _inherits(Menu, _React$Component);\n\n  function Menu(props) {\n    _classCallCheck(this, Menu);\n\n    var _this = _possibleConstructorReturn(this, (Menu.__proto__ || Object.getPrototypeOf(Menu)).call(this, props));\n\n    _this.onMenuOk = function () {\n      var onOk = _this.props.onOk;\n\n      if (onOk) {\n        onOk(_this.state.value);\n      }\n    };\n\n    _this.onMenuCancel = function () {\n      var onCancel = _this.props.onCancel;\n\n      if (onCancel) {\n        onCancel();\n      }\n    };\n\n    _this.onClickFirstLevelItem = function (dataItem) {\n      var onChange = _this.props.onChange;\n\n      _this.setState({\n        firstLevelSelectValue: dataItem.value\n      });\n\n      if (dataItem.isLeaf && onChange) {\n        onChange([dataItem.value]);\n      }\n    };\n\n    _this.getSelectValue = function (dataItem) {\n      var _this$props = _this.props,\n          level = _this$props.level,\n          multiSelect = _this$props.multiSelect;\n\n      if (multiSelect) {\n        var _this$state = _this.state,\n            value = _this$state.value,\n            firstLevelSelectValue = _this$state.firstLevelSelectValue;\n\n        if (value && value.length > 0) {\n          if (level === 2 && value[0] !== firstLevelSelectValue) {\n            /* if level is 2, when first level is reselect, reset submenu array */\n            return [firstLevelSelectValue, [dataItem.value]];\n          } else {\n            /* if level is 1, or first level isn't changed when level is 2, just do add or delete for submenu array  */\n            var chosenValues = level === 2 ? value[1] : value; // FIXME: hack type\n\n            var existIndex = chosenValues.indexOf(dataItem.value);\n\n            if (existIndex === -1) {\n              chosenValues.push(dataItem.value);\n            } else {\n              chosenValues.splice(existIndex, 1);\n            }\n\n            return value;\n          }\n        } else {\n          /* if value is not exist before, init value */\n          return level === 2 ? [firstLevelSelectValue, [dataItem.value]] : [dataItem.value];\n        }\n      }\n\n      return level === 2 ? [_this.state.firstLevelSelectValue, dataItem.value] : [dataItem.value];\n    };\n\n    _this.onClickSubMenuItem = function (dataItem) {\n      var onChange = _this.props.onChange;\n\n      var value = _this.getSelectValue(dataItem);\n\n      _this.setState({\n        value: value\n      });\n\n      setTimeout(function () {\n        // if onChange will close the menu, set a little time to show its selection state.\n        if (onChange) {\n          onChange(value);\n        }\n      }, 300);\n    };\n\n    _this.state = {\n      firstLevelSelectValue: _this.getNewFsv(props),\n      value: props.value,\n      height: props.height\n    };\n    return _this;\n  }\n\n  _createClass(Menu, [{\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.value !== this.props.value) {\n        this.setState({\n          firstLevelSelectValue: this.getNewFsv(nextProps),\n          value: nextProps.value\n        });\n      }\n\n      if (this.props.height !== nextProps.height) {\n        this.setState({\n          height: nextProps.height\n        });\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (!('height' in this.props)) {\n        this.setState({\n          height: Math.round(document.documentElement.clientHeight / 2)\n        });\n      }\n    }\n  }, {\n    key: 'getNewFsv',\n    value: function getNewFsv(props) {\n      var value = props.value,\n          data = props.data;\n      var firstValue = '';\n\n      if (value && value.length) {\n        // if has init path, chose init first value\n        firstValue = value[0]; // this is a contract\n      } else if (data && data.length && !data[0].isLeaf) {\n        // chose the first menu item if it's not leaf.\n        firstValue = data[0].value;\n      }\n\n      return firstValue;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          className = _props.className,\n          style = _props.style,\n          _props$data = _props.data,\n          data = _props$data === undefined ? [] : _props$data,\n          prefixCls = _props.prefixCls,\n          level = _props.level,\n          multiSelect = _props.multiSelect,\n          multiSelectMenuBtnsCls = _props.multiSelectMenuBtnsCls,\n          MenuSelectContanerPrefixCls = _props.MenuSelectContanerPrefixCls;\n      var _state = this.state,\n          firstLevelSelectValue = _state.firstLevelSelectValue,\n          value = _state.value,\n          height = _state.height;\n      var subMenuData = data; // menu only has one level as init\n\n      if (level === 2) {\n        var parent = data;\n\n        if (firstLevelSelectValue && firstLevelSelectValue !== '') {\n          parent = data.filter(function (dataItem) {\n            return dataItem.value === firstLevelSelectValue;\n          });\n        } // tslint:disable-next-line:prefer-conditional-expression\n\n\n        if (parent[0] && parent[0].children && parent[0].isLeaf !== true) {\n          subMenuData = parent[0].children;\n        } else {\n          subMenuData = [];\n        }\n      }\n\n      var subValue = value && value.length > 0 && [].concat(_toConsumableArray(value)) || [];\n\n      if (level === 2 && subValue.length > 1) {\n        subValue.shift();\n\n        if (multiSelect) {\n          /* example: [[1,2,3]] -> [1,2,3] */\n          subValue = subValue[0]; // FIXME: hack type\n        }\n      }\n\n      var parentValue = value && value.length > 1 && level === 2 ? value[0] : null;\n      var subSelInitItem = subMenuData.filter(function (dataItem) {\n        return subValue.indexOf(dataItem.value) !== -1;\n      }).map(function (item) {\n        return item.value;\n      });\n      var showSelect = true;\n\n      if (level === 2 && parentValue !== firstLevelSelectValue) {\n        showSelect = false;\n      } // tslint:disable-next-line:variable-name\n\n\n      var _locale = getComponentLocale(this.props, this.context, 'Menu', function () {\n        return require('./locale/zh_CN');\n      });\n\n      var heightStyle = height !== undefined ? {\n        height: height + 'px'\n      } : {};\n      return React.createElement(Flex, {\n        className: classnames(prefixCls, _defineProperty({}, className, !!className)),\n        style: _extends({}, style, heightStyle),\n        direction: 'column',\n        align: 'stretch'\n      }, React.createElement(Flex, {\n        align: 'start',\n        className: classnames(_defineProperty({}, MenuSelectContanerPrefixCls, true))\n      }, level === 2 && React.createElement(Flex.Item, null, React.createElement(List, {\n        role: 'tablist'\n      }, data.map(function (dataItem, index) {\n        return React.createElement(List.Item, {\n          className: dataItem.value === firstLevelSelectValue ? prefixCls + '-selected' : '',\n          onClick: function onClick() {\n            return _this2.onClickFirstLevelItem(dataItem);\n          },\n          key: 'listitem-1-' + index,\n          role: 'tab',\n          'aria-selected': dataItem.value === firstLevelSelectValue\n        }, dataItem.label);\n      }))), React.createElement(Flex.Item, {\n        role: 'tabpanel',\n        'aria-hidden': 'false',\n        className: MenuSelectContanerPrefixCls + '-submenu'\n      }, React.createElement(SubMenu, {\n        subMenuPrefixCls: this.props.subMenuPrefixCls,\n        radioPrefixCls: this.props.radioPrefixCls,\n        subMenuData: subMenuData,\n        selItem: subSelInitItem,\n        onSel: this.onClickSubMenuItem,\n        showSelect: showSelect,\n        multiSelect: multiSelect\n      }))), multiSelect && React.createElement('div', {\n        className: multiSelectMenuBtnsCls\n      }, React.createElement(Button, {\n        inline: true,\n        className: multiSelectMenuBtnsCls + '-btn',\n        onClick: this.onMenuCancel\n      }, _locale.cancelText), React.createElement(Button, {\n        inline: true,\n        type: 'primary',\n        className: multiSelectMenuBtnsCls + '-btn',\n        onClick: this.onMenuOk\n      }, _locale.okText)));\n    }\n  }]);\n\n  return Menu;\n}(React.Component);\n\nexport default Menu;\nMenu.defaultProps = {\n  prefixCls: 'am-menu',\n  subMenuPrefixCls: 'am-sub-menu',\n  radioPrefixCls: 'am-radio',\n  multiSelectMenuBtnsCls: 'am-multi-select-btns',\n  MenuSelectContanerPrefixCls: 'am-menu-select-container',\n  data: [],\n  level: 2,\n  onChange: function onChange() {},\n  onOk: function onOk() {},\n  onCancel: function onCancel() {},\n  multiSelect: false\n};\nMenu.contextTypes = {\n  antLocale: PropTypes.object\n};","map":{"version":3,"sources":["F:/1111111111/demo2/线下三阶段/三阶段小组项目/react/21cake/mycake/node_modules/antd-mobile/es/menu/index.js"],"names":["_extends","_defineProperty","_toConsumableArray","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","classnames","React","PropTypes","Button","Flex","List","getComponentLocale","SubMenu","Menu","_React$Component","props","_this","__proto__","Object","getPrototypeOf","call","onMenuOk","onOk","state","value","onMenuCancel","onCancel","onClickFirstLevelItem","dataItem","onChange","setState","firstLevelSelectValue","isLeaf","getSelectValue","_this$props","level","multiSelect","_this$state","length","chosenValues","existIndex","indexOf","push","splice","onClickSubMenuItem","setTimeout","getNewFsv","height","key","componentWillReceiveProps","nextProps","componentDidMount","Math","round","document","documentElement","clientHeight","data","firstValue","render","_this2","_props","className","style","_props$data","undefined","prefixCls","multiSelectMenuBtnsCls","MenuSelectContanerPrefixCls","_state","subMenuData","parent","filter","children","subValue","concat","shift","parentValue","subSelInitItem","map","item","showSelect","_locale","context","require","heightStyle","createElement","direction","align","Item","role","index","onClick","label","subMenuPrefixCls","radioPrefixCls","selItem","onSel","inline","cancelText","type","okText","Component","defaultProps","contextTypes","antLocale","object"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _toConsumableArray from 'babel-runtime/helpers/toConsumableArray';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n/* tslint:disable:jsx-no-multiline-js */\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport Button from '../button';\nimport Flex from '../flex';\nimport List from '../list';\nimport { getComponentLocale } from '../_util/getLocale';\nimport SubMenu from './SubMenu';\n\nvar Menu = function (_React$Component) {\n    _inherits(Menu, _React$Component);\n\n    function Menu(props) {\n        _classCallCheck(this, Menu);\n\n        var _this = _possibleConstructorReturn(this, (Menu.__proto__ || Object.getPrototypeOf(Menu)).call(this, props));\n\n        _this.onMenuOk = function () {\n            var onOk = _this.props.onOk;\n\n            if (onOk) {\n                onOk(_this.state.value);\n            }\n        };\n        _this.onMenuCancel = function () {\n            var onCancel = _this.props.onCancel;\n\n            if (onCancel) {\n                onCancel();\n            }\n        };\n        _this.onClickFirstLevelItem = function (dataItem) {\n            var onChange = _this.props.onChange;\n\n            _this.setState({\n                firstLevelSelectValue: dataItem.value\n            });\n            if (dataItem.isLeaf && onChange) {\n                onChange([dataItem.value]);\n            }\n        };\n        _this.getSelectValue = function (dataItem) {\n            var _this$props = _this.props,\n                level = _this$props.level,\n                multiSelect = _this$props.multiSelect;\n\n            if (multiSelect) {\n                var _this$state = _this.state,\n                    value = _this$state.value,\n                    firstLevelSelectValue = _this$state.firstLevelSelectValue;\n\n                if (value && value.length > 0) {\n                    if (level === 2 && value[0] !== firstLevelSelectValue) {\n                        /* if level is 2, when first level is reselect, reset submenu array */\n                        return [firstLevelSelectValue, [dataItem.value]];\n                    } else {\n                        /* if level is 1, or first level isn't changed when level is 2, just do add or delete for submenu array  */\n                        var chosenValues = level === 2 ? value[1] : value; // FIXME: hack type\n                        var existIndex = chosenValues.indexOf(dataItem.value);\n                        if (existIndex === -1) {\n                            chosenValues.push(dataItem.value);\n                        } else {\n                            chosenValues.splice(existIndex, 1);\n                        }\n                        return value;\n                    }\n                } else {\n                    /* if value is not exist before, init value */\n                    return level === 2 ? [firstLevelSelectValue, [dataItem.value]] : [dataItem.value];\n                }\n            }\n            return level === 2 ? [_this.state.firstLevelSelectValue, dataItem.value] : [dataItem.value];\n        };\n        _this.onClickSubMenuItem = function (dataItem) {\n            var onChange = _this.props.onChange;\n\n            var value = _this.getSelectValue(dataItem);\n            _this.setState({ value: value });\n            setTimeout(function () {\n                // if onChange will close the menu, set a little time to show its selection state.\n                if (onChange) {\n                    onChange(value);\n                }\n            }, 300);\n        };\n        _this.state = {\n            firstLevelSelectValue: _this.getNewFsv(props),\n            value: props.value,\n            height: props.height\n        };\n        return _this;\n    }\n\n    _createClass(Menu, [{\n        key: 'componentWillReceiveProps',\n        value: function componentWillReceiveProps(nextProps) {\n            if (nextProps.value !== this.props.value) {\n                this.setState({\n                    firstLevelSelectValue: this.getNewFsv(nextProps),\n                    value: nextProps.value\n                });\n            }\n            if (this.props.height !== nextProps.height) {\n                this.setState({\n                    height: nextProps.height\n                });\n            }\n        }\n    }, {\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            if (!('height' in this.props)) {\n                this.setState({\n                    height: Math.round(document.documentElement.clientHeight / 2)\n                });\n            }\n        }\n    }, {\n        key: 'getNewFsv',\n        value: function getNewFsv(props) {\n            var value = props.value,\n                data = props.data;\n\n            var firstValue = '';\n            if (value && value.length) {\n                // if has init path, chose init first value\n                firstValue = value[0]; // this is a contract\n            } else if (data && data.length && !data[0].isLeaf) {\n                // chose the first menu item if it's not leaf.\n                firstValue = data[0].value;\n            }\n            return firstValue;\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _this2 = this;\n\n            var _props = this.props,\n                className = _props.className,\n                style = _props.style,\n                _props$data = _props.data,\n                data = _props$data === undefined ? [] : _props$data,\n                prefixCls = _props.prefixCls,\n                level = _props.level,\n                multiSelect = _props.multiSelect,\n                multiSelectMenuBtnsCls = _props.multiSelectMenuBtnsCls,\n                MenuSelectContanerPrefixCls = _props.MenuSelectContanerPrefixCls;\n            var _state = this.state,\n                firstLevelSelectValue = _state.firstLevelSelectValue,\n                value = _state.value,\n                height = _state.height;\n\n            var subMenuData = data; // menu only has one level as init\n            if (level === 2) {\n                var parent = data;\n                if (firstLevelSelectValue && firstLevelSelectValue !== '') {\n                    parent = data.filter(function (dataItem) {\n                        return dataItem.value === firstLevelSelectValue;\n                    });\n                }\n                // tslint:disable-next-line:prefer-conditional-expression\n                if (parent[0] && parent[0].children && parent[0].isLeaf !== true) {\n                    subMenuData = parent[0].children;\n                } else {\n                    subMenuData = [];\n                }\n            }\n            var subValue = value && value.length > 0 && [].concat(_toConsumableArray(value)) || [];\n            if (level === 2 && subValue.length > 1) {\n                subValue.shift();\n                if (multiSelect) {\n                    /* example: [[1,2,3]] -> [1,2,3] */\n                    subValue = subValue[0]; // FIXME: hack type\n                }\n            }\n            var parentValue = value && value.length > 1 && level === 2 ? value[0] : null;\n            var subSelInitItem = subMenuData.filter(function (dataItem) {\n                return subValue.indexOf(dataItem.value) !== -1;\n            }).map(function (item) {\n                return item.value;\n            });\n            var showSelect = true;\n            if (level === 2 && parentValue !== firstLevelSelectValue) {\n                showSelect = false;\n            }\n            // tslint:disable-next-line:variable-name\n            var _locale = getComponentLocale(this.props, this.context, 'Menu', function () {\n                return require('./locale/zh_CN');\n            });\n            var heightStyle = height !== undefined ? {\n                height: height + 'px'\n            } : {};\n            return React.createElement(\n                Flex,\n                { className: classnames(prefixCls, _defineProperty({}, className, !!className)), style: _extends({}, style, heightStyle), direction: 'column', align: 'stretch' },\n                React.createElement(\n                    Flex,\n                    { align: 'start', className: classnames(_defineProperty({}, MenuSelectContanerPrefixCls, true)) },\n                    level === 2 && React.createElement(\n                        Flex.Item,\n                        null,\n                        React.createElement(\n                            List,\n                            { role: 'tablist' },\n                            data.map(function (dataItem, index) {\n                                return React.createElement(\n                                    List.Item,\n                                    { className: dataItem.value === firstLevelSelectValue ? prefixCls + '-selected' : '', onClick: function onClick() {\n                                            return _this2.onClickFirstLevelItem(dataItem);\n                                        }, key: 'listitem-1-' + index, role: 'tab', 'aria-selected': dataItem.value === firstLevelSelectValue },\n                                    dataItem.label\n                                );\n                            })\n                        )\n                    ),\n                    React.createElement(\n                        Flex.Item,\n                        { role: 'tabpanel', 'aria-hidden': 'false', className: MenuSelectContanerPrefixCls + '-submenu' },\n                        React.createElement(SubMenu, { subMenuPrefixCls: this.props.subMenuPrefixCls, radioPrefixCls: this.props.radioPrefixCls, subMenuData: subMenuData, selItem: subSelInitItem, onSel: this.onClickSubMenuItem, showSelect: showSelect, multiSelect: multiSelect })\n                    )\n                ),\n                multiSelect && React.createElement(\n                    'div',\n                    { className: multiSelectMenuBtnsCls },\n                    React.createElement(\n                        Button,\n                        { inline: true, className: multiSelectMenuBtnsCls + '-btn', onClick: this.onMenuCancel },\n                        _locale.cancelText\n                    ),\n                    React.createElement(\n                        Button,\n                        { inline: true, type: 'primary', className: multiSelectMenuBtnsCls + '-btn', onClick: this.onMenuOk },\n                        _locale.okText\n                    )\n                )\n            );\n        }\n    }]);\n\n    return Menu;\n}(React.Component);\n\nexport default Menu;\n\nMenu.defaultProps = {\n    prefixCls: 'am-menu',\n    subMenuPrefixCls: 'am-sub-menu',\n    radioPrefixCls: 'am-radio',\n    multiSelectMenuBtnsCls: 'am-multi-select-btns',\n    MenuSelectContanerPrefixCls: 'am-menu-select-container',\n    data: [],\n    level: 2,\n    onChange: function onChange() {},\n    onOk: function onOk() {},\n    onCancel: function onCancel() {},\n    multiSelect: false\n};\nMenu.contextTypes = {\n    antLocale: PropTypes.object\n};"]},"metadata":{},"sourceType":"module"}