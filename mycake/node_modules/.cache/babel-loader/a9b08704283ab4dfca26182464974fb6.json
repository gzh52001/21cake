{"ast":null,"code":"import _regeneratorRuntime from\"F:\\\\1111111111\\\\demo2\\\\\\u7EBF\\u4E0B\\u4E09\\u9636\\u6BB5\\\\\\u4E09\\u9636\\u6BB5\\u5C0F\\u7EC4\\u9879\\u76EE\\\\react\\\\21cake\\\\mycake\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"F:\\\\1111111111\\\\demo2\\\\\\u7EBF\\u4E0B\\u4E09\\u9636\\u6BB5\\\\\\u4E09\\u9636\\u6BB5\\u5C0F\\u7EC4\\u9879\\u76EE\\\\react\\\\21cake\\\\mycake\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"F:\\\\1111111111\\\\demo2\\\\\\u7EBF\\u4E0B\\u4E09\\u9636\\u6BB5\\\\\\u4E09\\u9636\\u6BB5\\u5C0F\\u7EC4\\u9879\\u76EE\\\\react\\\\21cake\\\\mycake\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"F:\\\\1111111111\\\\demo2\\\\\\u7EBF\\u4E0B\\u4E09\\u9636\\u6BB5\\\\\\u4E09\\u9636\\u6BB5\\u5C0F\\u7EC4\\u9879\\u76EE\\\\react\\\\21cake\\\\mycake\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"F:\\\\1111111111\\\\demo2\\\\\\u7EBF\\u4E0B\\u4E09\\u9636\\u6BB5\\\\\\u4E09\\u9636\\u6BB5\\u5C0F\\u7EC4\\u9879\\u76EE\\\\react\\\\21cake\\\\mycake\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"F:\\\\1111111111\\\\demo2\\\\\\u7EBF\\u4E0B\\u4E09\\u9636\\u6BB5\\\\\\u4E09\\u9636\\u6BB5\\u5C0F\\u7EC4\\u9879\\u76EE\\\\react\\\\21cake\\\\mycake\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Tabs,Toast}from'antd-mobile';import{withRouter}from'react-router-dom';import'./type.css';import http from'../../utils/http';//成功提示框\nfunction successToast(){Toast.success('成功添加到购物车！',1);}var Type=/*#__PURE__*/function(_Component){_inherits(Type,_Component);var _super=_createSuper(Type);function Type(){var _this;_classCallCheck(this,Type);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={tabs:[{title:'蛋糕',sub:'1',type:'cake'},{title:'面包',sub:'2',type:'bread'},{title:'咖啡下午茶',sub:'3',type:'cake'},{title:'冰淇淋',sub:'4',type:'cake'},{title:'常温蛋糕',sub:'5',type:'cake'},{title:'设计师礼品',sub:'6',type:'cake'}],type:'cake',//默认是cake,\ntypename:'',typrtitle:'',initialPage:0};_this.getdata=function(type){// console.log(\"initialPage:\"+this.state.initialPage);\n// console.log(this.state.initialPage);\nvar data=http.get(\"/good/type/\"+type);data.then(function(res){_this.setState({typedata:res.data,type:type});_this.showdata(type);});};_this.add=function(gid){// console.log(gid);\n//根据商品id先查询这个商品信息，然后加到购物车\nhttp.get('/good/getgood/'+gid).then(function(res){// console.log(res);\n//获取改商品信息\nvar goodmsg=res.data.p[0];//   goodmsg.weight1++;\n//然后存到数据库，购物车那边再调用\n//   console.log(goodmsg);\nhttp.post('/shopcar/addgoods',{gid:goodmsg.gid,img:goodmsg.img,cname:goodmsg.chtitle,ename:goodmsg.egtitle,weight:goodmsg.weight,weight1:1,weight2:goodmsg.weight2,weight3:goodmsg.weight3,weight4:goodmsg.weight4,price:goodmsg.price}).then(function(res){// console.log(res);\n//成功后弹出提醒\nif(res.flag){successToast();}});});};_this.showdata=function(type){var typename='';var typrtitle='';switch(type){case'cake':typename='蛋糕';typrtitle='新鲜乳脂奶油蛋糕';break;case'icecream':typename='冰淇淋';typrtitle='10天生命的意式杰拉朵冰淇淋';break;case'tea':typename='奶羹和雪酪';typrtitle='奶羹和雪酪';break;case'bread':typename='面包';typrtitle='面包';break;}return/*#__PURE__*/React.createElement(\"div\",{className:\"list-pro-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"pro-list-title\",id:\"list-title-1\"},/*#__PURE__*/React.createElement(\"h2\",null,typename,/*#__PURE__*/React.createElement(\"span\",null,typrtitle))),/*#__PURE__*/React.createElement(\"div\",{className:\"list-box\"},/*#__PURE__*/React.createElement(\"ul\",null,_this.state.typedata.map(function(item){return/*#__PURE__*/React.createElement(\"li\",{id:\"list-goods-\",key:item.gid},/*#__PURE__*/React.createElement(\"div\",{className:\"list-goods-pdleft\"},/*#__PURE__*/React.createElement(\"div\",{className:\"list-pro-content\"},/*#__PURE__*/React.createElement(\"a\",{title:item.chtitle,onClick:_this.gogoods.bind(null,item.gid)},/*#__PURE__*/React.createElement(\"div\",{className:\"list-pro-img\"},/*#__PURE__*/React.createElement(\"img\",{src:item.img})),/*#__PURE__*/React.createElement(\"h3\",null,item.egtitle,/*#__PURE__*/React.createElement(\"span\",null,item.chtitle)),/*#__PURE__*/React.createElement(\"span\",{className:\"price\"},\"\\xA5\".concat(item.price,\".00/454g(1.0\\u78C5)\")),/*#__PURE__*/React.createElement(\"div\",{className:\"label\"},/*#__PURE__*/React.createElement(\"img\",{src:\"https://m.21cake.com/upload/images/1e22720bd656f7bac246159010c7e1f4.png\"}))),/*#__PURE__*/React.createElement(\"a\",{className:\"cart-add\",name:\"cart-add_1318\",\"data-id\":\"1318\",onClick:_this.add.bind(null,item.gid)},/*#__PURE__*/React.createElement(\"img\",{src:\"https://static.21cake.com//themes/wap/img/list-cart.png\"})))));}))));};_this.gogoods=function(gid){_this.props.history.push(\"/goods/\".concat(gid));};return _this;}_createClass(Type,[{key:\"componentWillMount\",// componentWillMount(i){\n//     this.setState({initialPage:1})\n// }\nvalue:function(){var _componentWillMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var goodtype,i;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://如果首页点击蛋糕、面包就会在这里进行接收\ngoodtype=this.props.location.pathname.split(\"\".concat(this.props.match.path,\"/\"))[1];// console.log(goodtype);\nif(!goodtype){_context.next=13;break;}i=0;case 3:if(!(i<this.state.tabs.length)){_context.next=11;break;}if(!(this.state.tabs[i].type==goodtype)){_context.next=8;break;}_context.next=7;return this.setState({initialPage:i});case 7:// console.log(\"initialPage:\"+this.state.initialPage);\nthis.getdata(goodtype);// break;\ncase 8:i++;_context.next=3;break;case 11:_context.next=14;break;case 13://初始化渲染cake的数据\nthis.getdata(this.state.type);case 14:case\"end\":return _context.stop();}}},_callee,this);}));function componentWillMount(){return _componentWillMount.apply(this,arguments);}return componentWillMount;}()//切换type的时候\n},{key:\"render\",value:function render(){var _this2=this;var typedata=this.state.typedata;return/*#__PURE__*/React.createElement(\"div\",{className:\"type\"},/*#__PURE__*/React.createElement(Tabs,{tabs:this.state.tabs//初始化值\n,initialPage:this.state.initialPage//高亮字体颜色\n,tabBarActiveTextColor:'#442818'//切换type\n,onChange:function onChange(tab,index){_this2.getdata(tab.type);}},typedata?this.showdata.bind(null,this.state.type):null),/*#__PURE__*/React.createElement(\"div\",{className:\"lost-bottom\"},/*#__PURE__*/React.createElement(\"div\",null,\"\\u6CA1\\u4E86\")),/*#__PURE__*/React.createElement(\"div\",{className:\"footer\"},/*#__PURE__*/React.createElement(\"ul\",null,/*#__PURE__*/React.createElement(\"li\",{id:\"appDownloadLink\"},/*#__PURE__*/React.createElement(\"a\",{href:\"https://m.21cake.com/appdown.html\"},\"\\u4E0B\\u8F7DAPP\")),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"a\",null,\"\\u8054\\u7CFB\\u6211\\u4EEC\")),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"a\",null,\"\\u5168\\u7AD9\\u516C\\u544A\")),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"a\",null,\"\\u751F\\u4EA7\\u7ECF\\u8425\\u8D44\\u8D28\"))),/*#__PURE__*/React.createElement(\"p\",null,\"Copyright\\xA9 21Cake\\u86CB\\u7CD5\\u5B98\\u7F51\\u5546\\u57CE 2007-2020,\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u7248\\u6743\\u6240\\u6709\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u4EACICP\\u590714006254\\u53F7-1\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u7F51\\u7AD9\\u6CE8\\u518C\\u516C\\u53F8\\u540D\\u79F0: \\u5317\\u4EAC\\u5EFF\\u4E00\\u5BA2\\u98DF\\u54C1\\u6709\\u9650\\u516C\\u53F8\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u7F51\\u7AD9\\u8FD0\\u8425\\uFF1A\\u5EFF\\u4E00\\u5BA2\\uFF08\\u4E0A\\u6D77\\uFF09\\u7535\\u5B50\\u5546\\u52A1\\u6709\\u9650\\u516C\\u53F8\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u4E0A\\u6D77\\u5EFF\\u4E00\\u5BA2\\u98DF\\u54C1\\u6709\\u9650\\u516C\\u53F8\\u5206\\u516C\\u53F8\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u676D\\u5DDE\\u5EFF\\u4E00\\u5BA2\\u98DF\\u54C1\\u6709\\u9650\\u516C\\u53F8\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u5E7F\\u5DDE\\u5EFF\\u4E00\\u5BA2\\u98DF\\u54C1\\u6709\\u9650\\u516C\\u53F8\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u5317\\u4EAC\\u5EFF\\u4E00\\u5BA2\\u98DF\\u54C1\\u6709\\u9650\\u516C\\u53F8\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u6DF1\\u5733\\u5EFF\\u4E00\\u5BA2\\u8D38\\u6613\\u6709\\u9650\\u516C\\u53F8\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u5929\\u6D25\\u5EFF\\u4E00\\u5BA2\\u98DF\\u54C1\\u6709\\u9650\\u516C\\u53F8\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u5E7F\\u5DDE\\u5EFF\\u4E00\\u5BA2\\u98DF\\u54C1\\u8D38\\u6613\\u6709\\u9650\\u516C\\u53F8\",/*#__PURE__*/React.createElement(\"br\",null),\"\\u4E3E\\u5B9E\\uFF08\\u4E0A\\u6D77\\uFF09\\u98DF\\u54C1\\u6709\\u9650\\u516C\\u53F8\")));}}]);return Type;}(Component);Type=withRouter(Type);export default Type;","map":{"version":3,"sources":["F:/1111111111/demo2/线下三阶段/三阶段小组项目/react/21cake/mycake/src/pages/Type/index.js"],"names":["React","Component","Tabs","Toast","withRouter","http","successToast","success","Type","state","tabs","title","sub","type","typename","typrtitle","initialPage","getdata","data","get","then","res","setState","typedata","showdata","add","gid","goodmsg","p","post","img","cname","chtitle","ename","egtitle","weight","weight1","weight2","weight3","weight4","price","flag","map","item","gogoods","bind","props","history","push","goodtype","location","pathname","split","match","path","i","length","tab","index"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Tabs,Toast} from 'antd-mobile';\r\nimport {withRouter} from 'react-router-dom';\r\nimport './type.css'\r\nimport http from '../../utils/http'\r\n\r\n//成功提示框\r\nfunction successToast() {\r\n    Toast.success('成功添加到购物车！', 1);\r\n  }\r\n\r\nclass Type extends Component {\r\n    state={\r\n        tabs:[\r\n                { title: '蛋糕', sub: '1' ,type:'cake'},\r\n                { title: '面包', sub: '2',type:'bread' },\r\n                { title: '咖啡下午茶', sub: '3',type:'cake' },\r\n                { title: '冰淇淋', sub: '4',type:'cake' },\r\n                { title: '常温蛋糕', sub: '5',type:'cake' },\r\n                { title: '设计师礼品', sub: '6',type:'cake' },\r\n            ],\r\n        type:'cake',//默认是cake,\r\n        typename:'',\r\n        typrtitle:'',\r\n        initialPage:0\r\n    }\r\n    // componentWillMount(i){\r\n    //     this.setState({initialPage:1})\r\n    // }\r\n    async componentWillMount(){\r\n        //如果首页点击蛋糕、面包就会在这里进行接收\r\n        let goodtype=this.props.location.pathname.split(`${this.props.match.path}/`)[1]\r\n        // console.log(goodtype);\r\n        \r\n        if(goodtype){\r\n            //先找到传进来的type在tabs中的index然后设置给initialPage\r\n            for(var i=0;i<this.state.tabs.length;i++){\r\n                if(this.state.tabs[i].type==goodtype){\r\n                    await this.setState({initialPage:i});\r\n                    // console.log(\"initialPage:\"+this.state.initialPage);\r\n                    this.getdata(goodtype);\r\n                    // break;\r\n                }\r\n            }\r\n        }else{\r\n            //初始化渲染cake的数据\r\n            this.getdata(this.state.type)\r\n        }\r\n        \r\n        \r\n    }\r\n    //切换type的时候\r\n    getdata=(type)=>{\r\n        // console.log(\"initialPage:\"+this.state.initialPage);\r\n        // console.log(this.state.initialPage);\r\n        const data=  http.get(`/good/type/`+type)\r\n        data.then(res=>{\r\n            this.setState({typedata:res.data,type});\r\n            this.showdata(type)\r\n        })\r\n    }\r\n    add=(gid)=>{\r\n        // console.log(gid);\r\n        //根据商品id先查询这个商品信息，然后加到购物车\r\n        http.get('/good/getgood/'+gid).then(res=>{\r\n            // console.log(res);\r\n          //获取改商品信息\r\n          let goodmsg= res.data.p[0];\r\n        //   goodmsg.weight1++;\r\n          //然后存到数据库，购物车那边再调用\r\n        //   console.log(goodmsg);\r\n          http.post('/shopcar/addgoods',{\r\n              gid:goodmsg.gid,\r\n              img:goodmsg.img,\r\n              cname:goodmsg.chtitle,\r\n              ename:goodmsg.egtitle,\r\n              weight:goodmsg.weight,\r\n              weight1:1,\r\n              weight2:goodmsg.weight2,\r\n              weight3:goodmsg.weight3,\r\n              weight4:goodmsg.weight4,\r\n              price:goodmsg.price}).then(res=>{\r\n            // console.log(res);\r\n          //成功后弹出提醒\r\n          if(res.flag){\r\n            successToast()\r\n          }\r\n          \r\n          })\r\n        });\r\n      }\r\n    //不同类型商品跳转不同页面\r\n    showdata=(type)=>{\r\n        let typename=''\r\n        let typrtitle=''\r\n        switch(type){\r\n            case 'cake':typename='蛋糕';typrtitle='新鲜乳脂奶油蛋糕';\r\n                break;\r\n            case 'icecream':typename='冰淇淋';typrtitle='10天生命的意式杰拉朵冰淇淋';\r\n                break;\r\n            case 'tea':typename='奶羹和雪酪';typrtitle='奶羹和雪酪';\r\n                break;\r\n            case 'bread':typename='面包';typrtitle='面包';\r\n                break;\r\n        }\r\n        return (\r\n            <div className='list-pro-box'>\r\n                <div className='pro-list-title' id='list-title-1'>\r\n                    <h2>\r\n                        {typename}\r\n                        <span>{typrtitle}</span>\r\n                    </h2>\r\n                </div>\r\n                <div className='list-box'>\r\n                    <ul>\r\n                        {this.state.typedata.map(item=>(\r\n                            <li id='list-goods-'  key={item.gid}>\r\n                                <div className='list-goods-pdleft'>\r\n                                    <div className='list-pro-content'>\r\n                                        <a title={item.chtitle} onClick={this.gogoods.bind(null,item.gid)}>\r\n                                            <div className='list-pro-img' >\r\n                                                <img src={item.img}></img>\r\n                                            </div>\r\n                                            <h3 >\r\n                                            {item.egtitle}\r\n                                            <span >{item.chtitle}</span>\r\n                                            </h3>\r\n                                            <span className='price'>{`¥${item.price}.00/454g(1.0磅)`}</span>\r\n                                            <div className='label'>\r\n                                                <img src='https://m.21cake.com/upload/images/1e22720bd656f7bac246159010c7e1f4.png'></img>\r\n                                            </div>\r\n                                        </a>\r\n                                        <a className='cart-add' name='cart-add_1318' data-id='1318' onClick={this.add.bind(null,item.gid)}>\r\n                                            <img src='https://static.21cake.com//themes/wap/img/list-cart.png'></img>\r\n                                        </a>\r\n                                    </div>\r\n                                </div>\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n            )\r\n    }\r\n    //对应商品跳转到详情页面\r\n    gogoods=(gid)=>{\r\n        this.props.history.push(`/goods/${gid}`)\r\n    }\r\n    \r\n    render() {\r\n        const {typedata}=this.state;\r\n        return (\r\n            <div className=\"type\">\r\n                <Tabs tabs={this.state.tabs}\r\n                //初始化值\r\n                initialPage={this.state.initialPage}\r\n                //高亮字体颜色\r\n                tabBarActiveTextColor={'#442818'}\r\n                //切换type\r\n                onChange={(tab, index) => { this.getdata(tab.type)}}\r\n                >\r\n                    {typedata ? this.showdata.bind(null,this.state.type) : null}\r\n                    \r\n                </Tabs>\r\n                <div className='lost-bottom'>\r\n                    <div>没了</div>\r\n                </div>\r\n                <div className='footer'>\r\n                    <ul>\r\n                    <li id='appDownloadLink'>\r\n                        <a href='https://m.21cake.com/appdown.html'>下载APP</a>\r\n                    </li>\r\n                    <li>\r\n                        <a >联系我们</a>\r\n                    </li>\r\n                    <li>\r\n                        <a >全站公告</a>\r\n                    </li>\r\n                    <li>\r\n                        <a >生产经营资质</a>\r\n                    </li>\r\n                    </ul>\r\n                    <p>\r\n                    Copyright© 21Cake蛋糕官网商城 2007-2020, \r\n                    <br></br>        \r\n                    版权所有 \r\n                    <br></br>  \r\n                    京ICP备14006254号-1\r\n                    <br></br>  \r\n                    网站注册公司名称: 北京廿一客食品有限公司\r\n                    <br></br>  \r\n                    网站运营：廿一客（上海）电子商务有限公司\r\n                    <br></br>  \r\n                    上海廿一客食品有限公司分公司\r\n                    <br></br>  \r\n                    杭州廿一客食品有限公司\r\n                    <br></br>  \r\n                    广州廿一客食品有限公司\r\n                    <br></br>  \r\n                    北京廿一客食品有限公司\r\n                    <br></br>  \r\n                    深圳廿一客贸易有限公司\r\n                    <br></br>  \r\n                    天津廿一客食品有限公司\r\n                    <br></br>  \r\n                    广州廿一客食品贸易有限公司\r\n                    <br></br>  \r\n                    举实（上海）食品有限公司\r\n                    </p>\r\n                </div>\r\n          \r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nType = withRouter(Type)\r\nexport default Type\r\n\r\n"]},"metadata":{},"sourceType":"module"}