{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport TouchFeedback from 'rmc-feedback';\nimport getDataAttr from '../_util/getDataAttr';\nimport { getComponentLocale } from '../_util/getLocale';\nimport { defaultProps } from './PropsType';\n\nfunction onNextFrame(cb) {\n  if (window.requestAnimationFrame) {\n    return window.requestAnimationFrame(cb);\n  }\n\n  return window.setTimeout(cb, 1);\n}\n\nfunction clearNextFrameAction(nextFrameId) {\n  if (window.cancelAnimationFrame) {\n    window.cancelAnimationFrame(nextFrameId);\n  } else {\n    window.clearTimeout(nextFrameId);\n  }\n}\n\nvar SearchBar = function (_React$Component) {\n  _inherits(SearchBar, _React$Component);\n\n  function SearchBar(props) {\n    _classCallCheck(this, SearchBar);\n\n    var _this = _possibleConstructorReturn(this, (SearchBar.__proto__ || Object.getPrototypeOf(SearchBar)).call(this, props));\n\n    _this.onSubmit = function (e) {\n      e.preventDefault();\n\n      if (_this.props.onSubmit) {\n        _this.props.onSubmit(_this.state.value || '');\n      }\n\n      if (_this.inputRef) {\n        _this.inputRef.blur();\n      }\n    };\n\n    _this.onChange = function (e) {\n      if (!_this.state.focus) {\n        _this.setState({\n          focus: true\n        });\n      }\n\n      var value = e.target.value;\n\n      if (!('value' in _this.props)) {\n        _this.setState({\n          value: value\n        });\n      }\n\n      if (_this.props.onChange) {\n        _this.props.onChange(value);\n      }\n    };\n\n    _this.onFocus = function () {\n      _this.setState({\n        focus: true\n      });\n\n      _this.firstFocus = true;\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus();\n      }\n    };\n\n    _this.onBlur = function () {\n      _this.onBlurTimeout = onNextFrame(function () {\n        if (!_this.blurFromOnClear) {\n          if (document.activeElement !== _this.inputRef) {\n            _this.setState({\n              focus: false\n            });\n          }\n        }\n\n        _this.blurFromOnClear = false;\n      });\n\n      if (_this.props.onBlur) {\n        // fix autoFocus item blur with flash\n        setTimeout(function () {\n          // fix ios12 wechat browser click failure after input\n          if (document.body) {\n            document.body.scrollTop = document.body.scrollTop;\n          }\n        }, 100);\n\n        _this.props.onBlur();\n      }\n    };\n\n    _this.onClear = function () {\n      _this.doClear();\n    };\n\n    _this.doClear = function () {\n      var blurFromOnClear = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      _this.blurFromOnClear = blurFromOnClear;\n\n      if (!('value' in _this.props)) {\n        _this.setState({\n          value: ''\n        });\n      }\n\n      if (_this.props.onClear) {\n        _this.props.onClear('');\n      }\n\n      if (_this.props.onChange) {\n        _this.props.onChange('');\n      }\n\n      if (blurFromOnClear) {\n        _this.focus();\n      }\n    };\n\n    _this.onCancel = function () {\n      if (_this.props.onCancel) {\n        _this.props.onCancel(_this.state.value || '');\n      } else {\n        _this.doClear(false);\n      }\n    };\n\n    _this.focus = function () {\n      if (_this.inputRef) {\n        _this.inputRef.focus();\n      }\n    };\n\n    var value = void 0;\n\n    if ('value' in props) {\n      value = props.value || '';\n    } else if ('defaultValue' in props) {\n      value = props.defaultValue;\n    } else {\n      value = '';\n    }\n\n    _this.state = {\n      value: value,\n      focus: false\n    };\n    return _this;\n  }\n\n  _createClass(SearchBar, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (this.rightBtnRef) {\n        var initBtn = window.getComputedStyle(this.rightBtnRef);\n        this.rightBtnInitMarginleft = initBtn.marginLeft;\n      }\n\n      this.componentDidUpdate();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      if (this.syntheticPhRef) {\n        if (this.inputContainerRef && this.inputContainerRef.className.indexOf(this.props.prefixCls + '-start') > -1) {\n          // 检测是否包含名为 ${this.props.prefixCls}-start 样式，生成动画\n          // offsetWidth 某些时候是向上取整，某些时候是向下取整，不能用\n          if (this.syntheticPhContainerRef) {\n            var realWidth = this.syntheticPhContainerRef.getBoundingClientRect().width; // 包含小数\n\n            this.syntheticPhRef.style.width = Math.ceil(realWidth) + 'px';\n          }\n\n          if (!this.props.showCancelButton && this.rightBtnRef) {\n            this.rightBtnRef.style.marginRight = '0';\n          }\n        } else {\n          this.syntheticPhRef.style.width = '100%';\n\n          if (!this.props.showCancelButton && this.rightBtnRef) {\n            this.rightBtnRef.style.marginRight = '-' + (this.rightBtnRef.offsetWidth + (this.rightBtnInitMarginleft != null ? parseInt(this.rightBtnInitMarginleft, 10) : 0)) + 'px';\n          }\n        }\n      }\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if ('value' in nextProps && nextProps.value !== this.state.value) {\n        this.setState({\n          value: nextProps.value\n        });\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this.onBlurTimeout) {\n        clearNextFrameAction(this.onBlurTimeout);\n        this.onBlurTimeout = null;\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _classnames3,\n          _this2 = this;\n\n      var _props = this.props,\n          prefixCls = _props.prefixCls,\n          showCancelButton = _props.showCancelButton,\n          disabled = _props.disabled,\n          placeholder = _props.placeholder,\n          className = _props.className,\n          style = _props.style,\n          maxLength = _props.maxLength; // tslint:disable-next-line:variable-name\n\n      var _locale = getComponentLocale(this.props, this.context, 'SearchBar', function () {\n        return require('./locale/zh_CN');\n      });\n\n      var cancelText = _locale.cancelText;\n      var _state = this.state,\n          value = _state.value,\n          focus = _state.focus;\n      var wrapCls = classnames(prefixCls, className, _defineProperty({}, prefixCls + '-start', !!(focus || value && value.length > 0)));\n      var clearCls = classnames(prefixCls + '-clear', _defineProperty({}, prefixCls + '-clear-show', !!(focus && value && value.length > 0)));\n      var cancelCls = classnames(prefixCls + '-cancel', (_classnames3 = {}, _defineProperty(_classnames3, prefixCls + '-cancel-show', !!(showCancelButton || focus || value && value.length > 0)), _defineProperty(_classnames3, prefixCls + '-cancel-anim', this.firstFocus), _classnames3));\n      return React.createElement('form', {\n        onSubmit: this.onSubmit,\n        className: wrapCls,\n        style: style,\n        ref: function ref(el) {\n          return _this2.inputContainerRef = el;\n        },\n        action: '#'\n      }, React.createElement('div', {\n        className: prefixCls + '-input'\n      }, React.createElement('div', {\n        className: prefixCls + '-synthetic-ph',\n        ref: function ref(el) {\n          return _this2.syntheticPhRef = el;\n        }\n      }, React.createElement('span', {\n        className: prefixCls + '-synthetic-ph-container',\n        ref: function ref(el) {\n          return _this2.syntheticPhContainerRef = el;\n        }\n      }, React.createElement('i', {\n        className: prefixCls + '-synthetic-ph-icon'\n      }), React.createElement('span', {\n        className: prefixCls + '-synthetic-ph-placeholder' // tslint:disable-next-line:jsx-no-multiline-js\n        ,\n        style: {\n          visibility: placeholder && !value ? 'visible' : 'hidden'\n        }\n      }, placeholder))), React.createElement('input', _extends({\n        type: 'search',\n        className: prefixCls + '-value',\n        value: value,\n        disabled: disabled,\n        placeholder: placeholder,\n        onChange: this.onChange,\n        onFocus: this.onFocus,\n        onBlur: this.onBlur,\n        ref: function ref(el) {\n          return _this2.inputRef = el;\n        },\n        maxLength: maxLength\n      }, getDataAttr(this.props))), React.createElement(TouchFeedback, {\n        activeClassName: prefixCls + '-clear-active'\n      }, React.createElement('a', {\n        onClick: this.onClear,\n        className: clearCls\n      }))), React.createElement('div', {\n        className: cancelCls,\n        onClick: this.onCancel,\n        ref: function ref(el) {\n          return _this2.rightBtnRef = el;\n        }\n      }, this.props.cancelText || cancelText));\n    }\n  }]);\n\n  return SearchBar;\n}(React.Component);\n\nexport default SearchBar;\nSearchBar.defaultProps = defaultProps;\nSearchBar.contextTypes = {\n  antLocale: PropTypes.object\n};","map":{"version":3,"sources":["F:/1111111111/demo2/线下三阶段/三阶段小组项目/react/21cake/mycake/node_modules/antd-mobile/es/search-bar/index.js"],"names":["_extends","_defineProperty","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","classnames","React","PropTypes","TouchFeedback","getDataAttr","getComponentLocale","defaultProps","onNextFrame","cb","window","requestAnimationFrame","setTimeout","clearNextFrameAction","nextFrameId","cancelAnimationFrame","clearTimeout","SearchBar","_React$Component","props","_this","__proto__","Object","getPrototypeOf","call","onSubmit","e","preventDefault","state","value","inputRef","blur","onChange","focus","setState","target","onFocus","firstFocus","onBlur","onBlurTimeout","blurFromOnClear","document","activeElement","body","scrollTop","onClear","doClear","arguments","length","undefined","onCancel","defaultValue","key","componentDidMount","rightBtnRef","initBtn","getComputedStyle","rightBtnInitMarginleft","marginLeft","componentDidUpdate","syntheticPhRef","inputContainerRef","className","indexOf","prefixCls","syntheticPhContainerRef","realWidth","getBoundingClientRect","width","style","Math","ceil","showCancelButton","marginRight","offsetWidth","parseInt","componentWillReceiveProps","nextProps","componentWillUnmount","render","_classnames3","_this2","_props","disabled","placeholder","maxLength","_locale","context","require","cancelText","_state","wrapCls","clearCls","cancelCls","createElement","ref","el","action","visibility","type","activeClassName","onClick","Component","contextTypes","antLocale","object"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport classnames from 'classnames';\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport TouchFeedback from 'rmc-feedback';\nimport getDataAttr from '../_util/getDataAttr';\nimport { getComponentLocale } from '../_util/getLocale';\nimport { defaultProps } from './PropsType';\nfunction onNextFrame(cb) {\n    if (window.requestAnimationFrame) {\n        return window.requestAnimationFrame(cb);\n    }\n    return window.setTimeout(cb, 1);\n}\nfunction clearNextFrameAction(nextFrameId) {\n    if (window.cancelAnimationFrame) {\n        window.cancelAnimationFrame(nextFrameId);\n    } else {\n        window.clearTimeout(nextFrameId);\n    }\n}\n\nvar SearchBar = function (_React$Component) {\n    _inherits(SearchBar, _React$Component);\n\n    function SearchBar(props) {\n        _classCallCheck(this, SearchBar);\n\n        var _this = _possibleConstructorReturn(this, (SearchBar.__proto__ || Object.getPrototypeOf(SearchBar)).call(this, props));\n\n        _this.onSubmit = function (e) {\n            e.preventDefault();\n            if (_this.props.onSubmit) {\n                _this.props.onSubmit(_this.state.value || '');\n            }\n            if (_this.inputRef) {\n                _this.inputRef.blur();\n            }\n        };\n        _this.onChange = function (e) {\n            if (!_this.state.focus) {\n                _this.setState({\n                    focus: true\n                });\n            }\n            var value = e.target.value;\n            if (!('value' in _this.props)) {\n                _this.setState({ value: value });\n            }\n            if (_this.props.onChange) {\n                _this.props.onChange(value);\n            }\n        };\n        _this.onFocus = function () {\n            _this.setState({\n                focus: true\n            });\n            _this.firstFocus = true;\n            if (_this.props.onFocus) {\n                _this.props.onFocus();\n            }\n        };\n        _this.onBlur = function () {\n            _this.onBlurTimeout = onNextFrame(function () {\n                if (!_this.blurFromOnClear) {\n                    if (document.activeElement !== _this.inputRef) {\n                        _this.setState({\n                            focus: false\n                        });\n                    }\n                }\n                _this.blurFromOnClear = false;\n            });\n            if (_this.props.onBlur) {\n                // fix autoFocus item blur with flash\n                setTimeout(function () {\n                    // fix ios12 wechat browser click failure after input\n                    if (document.body) {\n                        document.body.scrollTop = document.body.scrollTop;\n                    }\n                }, 100);\n                _this.props.onBlur();\n            }\n        };\n        _this.onClear = function () {\n            _this.doClear();\n        };\n        _this.doClear = function () {\n            var blurFromOnClear = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n            _this.blurFromOnClear = blurFromOnClear;\n            if (!('value' in _this.props)) {\n                _this.setState({ value: '' });\n            }\n            if (_this.props.onClear) {\n                _this.props.onClear('');\n            }\n            if (_this.props.onChange) {\n                _this.props.onChange('');\n            }\n            if (blurFromOnClear) {\n                _this.focus();\n            }\n        };\n        _this.onCancel = function () {\n            if (_this.props.onCancel) {\n                _this.props.onCancel(_this.state.value || '');\n            } else {\n                _this.doClear(false);\n            }\n        };\n        _this.focus = function () {\n            if (_this.inputRef) {\n                _this.inputRef.focus();\n            }\n        };\n        var value = void 0;\n        if ('value' in props) {\n            value = props.value || '';\n        } else if ('defaultValue' in props) {\n            value = props.defaultValue;\n        } else {\n            value = '';\n        }\n        _this.state = {\n            value: value,\n            focus: false\n        };\n        return _this;\n    }\n\n    _createClass(SearchBar, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            if (this.rightBtnRef) {\n                var initBtn = window.getComputedStyle(this.rightBtnRef);\n                this.rightBtnInitMarginleft = initBtn.marginLeft;\n            }\n            this.componentDidUpdate();\n        }\n    }, {\n        key: 'componentDidUpdate',\n        value: function componentDidUpdate() {\n            if (this.syntheticPhRef) {\n                if (this.inputContainerRef && this.inputContainerRef.className.indexOf(this.props.prefixCls + '-start') > -1) {\n                    // 检测是否包含名为 ${this.props.prefixCls}-start 样式，生成动画\n                    // offsetWidth 某些时候是向上取整，某些时候是向下取整，不能用\n                    if (this.syntheticPhContainerRef) {\n                        var realWidth = this.syntheticPhContainerRef.getBoundingClientRect().width; // 包含小数\n                        this.syntheticPhRef.style.width = Math.ceil(realWidth) + 'px';\n                    }\n                    if (!this.props.showCancelButton && this.rightBtnRef) {\n                        this.rightBtnRef.style.marginRight = '0';\n                    }\n                } else {\n                    this.syntheticPhRef.style.width = '100%';\n                    if (!this.props.showCancelButton && this.rightBtnRef) {\n                        this.rightBtnRef.style.marginRight = '-' + (this.rightBtnRef.offsetWidth + (this.rightBtnInitMarginleft != null ? parseInt(this.rightBtnInitMarginleft, 10) : 0)) + 'px';\n                    }\n                }\n            }\n        }\n    }, {\n        key: 'componentWillReceiveProps',\n        value: function componentWillReceiveProps(nextProps) {\n            if ('value' in nextProps && nextProps.value !== this.state.value) {\n                this.setState({\n                    value: nextProps.value\n                });\n            }\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            if (this.onBlurTimeout) {\n                clearNextFrameAction(this.onBlurTimeout);\n                this.onBlurTimeout = null;\n            }\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _classnames3,\n                _this2 = this;\n\n            var _props = this.props,\n                prefixCls = _props.prefixCls,\n                showCancelButton = _props.showCancelButton,\n                disabled = _props.disabled,\n                placeholder = _props.placeholder,\n                className = _props.className,\n                style = _props.style,\n                maxLength = _props.maxLength;\n            // tslint:disable-next-line:variable-name\n\n            var _locale = getComponentLocale(this.props, this.context, 'SearchBar', function () {\n                return require('./locale/zh_CN');\n            });\n            var cancelText = _locale.cancelText;\n            var _state = this.state,\n                value = _state.value,\n                focus = _state.focus;\n\n            var wrapCls = classnames(prefixCls, className, _defineProperty({}, prefixCls + '-start', !!(focus || value && value.length > 0)));\n            var clearCls = classnames(prefixCls + '-clear', _defineProperty({}, prefixCls + '-clear-show', !!(focus && value && value.length > 0)));\n            var cancelCls = classnames(prefixCls + '-cancel', (_classnames3 = {}, _defineProperty(_classnames3, prefixCls + '-cancel-show', !!(showCancelButton || focus || value && value.length > 0)), _defineProperty(_classnames3, prefixCls + '-cancel-anim', this.firstFocus), _classnames3));\n            return React.createElement(\n                'form',\n                { onSubmit: this.onSubmit, className: wrapCls, style: style, ref: function ref(el) {\n                        return _this2.inputContainerRef = el;\n                    }, action: '#' },\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-input' },\n                    React.createElement(\n                        'div',\n                        { className: prefixCls + '-synthetic-ph', ref: function ref(el) {\n                                return _this2.syntheticPhRef = el;\n                            } },\n                        React.createElement(\n                            'span',\n                            { className: prefixCls + '-synthetic-ph-container', ref: function ref(el) {\n                                    return _this2.syntheticPhContainerRef = el;\n                                } },\n                            React.createElement('i', { className: prefixCls + '-synthetic-ph-icon' }),\n                            React.createElement(\n                                'span',\n                                { className: prefixCls + '-synthetic-ph-placeholder'\n                                    // tslint:disable-next-line:jsx-no-multiline-js\n                                    , style: {\n                                        visibility: placeholder && !value ? 'visible' : 'hidden'\n                                    } },\n                                placeholder\n                            )\n                        )\n                    ),\n                    React.createElement('input', _extends({ type: 'search', className: prefixCls + '-value', value: value, disabled: disabled, placeholder: placeholder, onChange: this.onChange, onFocus: this.onFocus, onBlur: this.onBlur, ref: function ref(el) {\n                            return _this2.inputRef = el;\n                        }, maxLength: maxLength }, getDataAttr(this.props))),\n                    React.createElement(\n                        TouchFeedback,\n                        { activeClassName: prefixCls + '-clear-active' },\n                        React.createElement('a', { onClick: this.onClear, className: clearCls })\n                    )\n                ),\n                React.createElement(\n                    'div',\n                    { className: cancelCls, onClick: this.onCancel, ref: function ref(el) {\n                            return _this2.rightBtnRef = el;\n                        } },\n                    this.props.cancelText || cancelText\n                )\n            );\n        }\n    }]);\n\n    return SearchBar;\n}(React.Component);\n\nexport default SearchBar;\n\nSearchBar.defaultProps = defaultProps;\nSearchBar.contextTypes = {\n    antLocale: PropTypes.object\n};"]},"metadata":{},"sourceType":"module"}